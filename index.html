<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GoalFlow | Agenda Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #000000;
            --surface: #121212;
            --accent: #FF2D55;
            --text-main: #FFFFFF;
            --text-dim: #8E8E93;
            --border: #222;
            --grid-line: #1c1c1c;
        }

        .light-theme {
            --bg: #FFFFFF;
            --surface: #F2F2F7;
            --text-main: #000000;
            --text-dim: #8E8E93;
            --border: #E5E5EA;
            --grid-line: #F2F2F7;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; transition: background 0.3s; }
        body { background-color: var(--bg); color: var(--text-main); height: 100vh; overflow: hidden; }

        .page { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none; flex-direction: column; padding-bottom: 90px; }
        .active-page { display: flex; }

        /* --- HEADER AGENDA --- */
        .agenda-header {
            display: grid;
            grid-template-columns: 60px repeat(7, 1fr);
            border-bottom: 1px solid var(--border);
            padding-top: 20px;
            background: var(--bg);
            position: sticky; top: 0; z-index: 10;
        }
        .header-day { text-align: center; padding: 10px 0; border-right: 1px solid transparent; }
        .header-day span { display: block; font-size: 10px; color: var(--text-dim); font-weight: 800; }
        .header-day b { font-size: 16px; }
        .header-day.today b { color: var(--accent); position: relative; }

        /* --- GRILLE --- */
        .agenda-container { flex: 1; overflow-y: auto; position: relative; }
        .time-grid { display: grid; grid-template-columns: 60px repeat(7, 1fr); position: relative; }
        .time-label { height: 80px; font-size: 11px; color: var(--text-dim); text-align: right; padding-right: 12px; margin-top: -8px; }
        .grid-cell { height: 80px; border-right: 1px solid var(--grid-line); border-bottom: 1px solid var(--grid-line); position: relative; }

        /* --- TASKS --- */
        .event-card {
            position: absolute;
            left: 2px; right: 2px;
            background: var(--accent);
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 6px;
            border-radius: 6px;
            overflow: hidden;
            z-index: 5;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            border-left: 3px solid rgba(255,255,255,0.3);
        }

        /* --- MODAL --- */
        #modal { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.85); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px;
        }
        .modal-box { 
            background: var(--surface); width: 100%; max-width: 400px; 
            border-radius: 30px; padding: 30px; border: 1px solid var(--border);
        }
        input, select { 
            width: 100%; background: var(--bg); border: 1px solid var(--border); 
            color: var(--text-main); padding: 15px; border-radius: 12px; margin-bottom: 15px; outline: none;
        }

        /* --- NAV --- */
        nav { position: fixed; bottom: 0; width: 100%; height: 85px; background: var(--bg); display: flex; justify-content: space-around; padding-top: 15px; border-top: 1px solid var(--border); }
        .nav-item { color: var(--text-dim); text-align: center; font-size: 10px; cursor: pointer; }
        .nav-item.active { color: var(--accent); }
        .nav-item i { font-size: 22px; margin-bottom: 4px; display: block; }
        
        .btn-add { 
            background: var(--accent); color: white; border: none; 
            width: 100%; padding: 18px; border-radius: 15px; font-weight: 900; cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="page-home" class="page active-page" style="padding: 30px;">
        <h1 style="font-size: 38px; font-weight: 900; margin-top: 50px; letter-spacing: -1px;">Agenda.<br><span style="color:var(--accent)">Elite</span></h1>
        <p style="color:var(--text-dim); margin-top: 10px;">Gérez votre temps comme un pro.</p>
        
        <div style="background:var(--surface); padding:25px; border-radius:30px; margin-top:40px; border:1px solid var(--border);" onclick="goToPage('weekly')">
            <p style="font-size: 12px; color:var(--accent); font-weight:800; letter-spacing:1px; margin-bottom:10px;">PLANNING</p>
            <h2 style="font-size: 20px;">Ouvrir la vue hebdomadaire</h2>
        </div>
    </div>

    <div id="page-weekly" class="page">
        <div class="agenda-header" id="agenda-header"></div>
        <div class="agenda-container">
            <div class="time-grid" id="time-grid"></div>
        </div>
    </div>

    <div id="modal">
        <div class="modal-box">
            <h2 style="margin-bottom:20px;">Nouvel Objectif</h2>
            <input type="text" id="task-title" placeholder="Titre de l'objectif...">
            <div style="display: flex; gap: 10px;">
                <select id="task-day">
                    <option value="0">Lundi</option>
                    <option value="1">Mardi</option>
                    <option value="2">Mercredi</option>
                    <option value="3">Jeudi</option>
                    <option value="4">Vendredi</option>
                    <option value="5">Samedi</option>
                    <option value="6">Dimanche</option>
                </select>
                <select id="task-hour">
                    </select>
            </div>
            <button class="btn-add" onclick="addTask()">PLANIFIER</button>
            <button style="background:transparent; color:var(--text-dim); border:none; width:100%; margin-top:15px;" onclick="closeModal()">Annuler</button>
        </div>
    </div>

    <nav>
        <div class="nav-item active" id="btn-home" onclick="goToPage('home')"><i class="fa-solid fa-house"></i><span>Home</span></div>
        <div class="nav-item" id="btn-weekly" onclick="goToPage('weekly')"><i class="fa-solid fa-calendar-days"></i><span>Agenda</span></div>
        <div class="nav-item" onclick="openModal()"><i class="fa-solid fa-circle-plus" style="color:var(--accent); font-size: 30px;"></i></div>
        <div class="nav-item" onclick="toggleTheme()"><i class="fa-solid fa-moon"></i><span>Thème</span></div>
    </nav>

<script>
    // Structure des données : { "0": [{h: 10, title: "Faire du sport"}], "1": [] }
    let calendarData = JSON.parse(localStorage.getItem('goalflow_calendar')) || { "0":[], "1":[], "2":[], "3":[], "4":[], "5":[], "6":[] };

    function toggleTheme() {
        document.body.classList.toggle('light-theme');
    }

    function openModal() { document.getElementById('modal').style.display = 'flex'; }
    function closeModal() { document.getElementById('modal').style.display = 'none'; }

    function goToPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById('page-' + pageId).classList.add('active-page');
        if(document.getElementById('btn-' + pageId)) document.getElementById('btn-' + pageId).classList.add('active');
        if(pageId === 'weekly') renderAgenda();
    }

    // Générer les heures dans le select
    const hourSelect = document.getElementById('task-hour');
    for(let i=7; i<=22; i++) {
        hourSelect.innerHTML += `<option value="${i}">${i}h00</option>`;
    }

    function addTask() {
        const title = document.getElementById('task-title').value;
        const day = document.getElementById('task-day').value;
        const hour = document.getElementById('task-hour').value;

        if(title) {
            calendarData[day].push({ title: title, hour: parseInt(hour) });
            localStorage.setItem('goalflow_calendar', JSON.stringify(calendarData));
            document.getElementById('task-title').value = '';
            closeModal();
            renderAgenda();
        }
    }

    function renderAgenda() {
        const header = document.getElementById('agenda-header');
        const grid = document.getElementById('time-grid');
        header.innerHTML = '<div></div>';
        grid.innerHTML = '';

        const days = ['LUN','MAR','MER','JEU','VEN','SAM','DIM'];
        
        // Header
        days.forEach((d, i) => {
            header.innerHTML += `<div class="header-day"><span>${d}</span><b>${7+i}</b></div>`;
        });

        // Grille et Tâches
        for(let h=7; h<=22; h++) {
            grid.innerHTML += `<div class="time-label">${h}:00</div>`;
            for(let d=0; d<7; d++) {
                const cell = document.createElement('div');
                cell.className = 'grid-cell';
                
                // Chercher si une tâche existe pour ce jour et cette heure
                const dayTasks = calendarData[d.toString()] || [];
                const task = dayTasks.find(t => t.hour === h);
                
                if(task) {
                    cell.innerHTML = `<div class="event-card">${task.title}</div>`;
                }
                
                grid.appendChild(cell);
            }
        }
    }

    // Initialisation
    renderAgenda();
</script>
</body>
</html>