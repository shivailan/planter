<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GoalFlow | All-in-One</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg: #F0F2F8;
            --surface: rgba(255, 255, 255, 0.85);
            --accent: #6366F1;
            --accent-soft: #EEF2FF;
            --text-main: #1E293B;
            --text-dim: #64748B;
            --border: rgba(226, 232, 240, 0.8);
            --success: #10B981;
            --hour-h: 90px;
            --day-w: 160px;
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { 
            background: var(--bg); 
            background-image: radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.1) 0px, transparent 50%), radial-gradient(at 100% 100%, rgba(168, 85, 247, 0.1) 0px, transparent 50%);
            color: var(--text-main); height: 100vh; overflow: hidden; letter-spacing: -0.02em; 
        }

        /* --- PAGES --- */
        .page { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: none; flex-direction: column; animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        .active-page { display: flex; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- TOP BAR --- */
        .top-bar { padding: 25px 30px; display: flex; justify-content: space-between; align-items: center; }
        .top-bar h1 { font-size: 20px; font-weight: 800; background: linear-gradient(135deg, #6366F1, #A855F7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .profile-mini { width: 40px; height: 40px; border-radius: 12px; background: white; border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; box-shadow: var(--glass-shadow); }

        /* --- PAGE 1: HOME --- */
        #page-home { padding: 40px 25px; }
        .hero-title { font-size: 42px; font-weight: 800; line-height: 1.1; margin-bottom: 10px; }
        .home-card-elite { background: var(--surface); backdrop-filter: blur(20px); border: 1px solid white; padding: 30px; border-radius: 35px; box-shadow: var(--glass-shadow); margin-top: 25px; }
        .home-card-elite h2 { font-size: 13px; font-weight: 700; color: var(--accent); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 10px; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 25px; }
        .stat-pill { background: white; padding: 25px; border-radius: 30px; border: 1px solid var(--border); text-align: center; }

        /* --- PAGE 2: FOCUS --- */
        #page-focus { padding: 20px; }
        .progress-circle-container { position: relative; width: 100px; height: 100px; margin: 10px auto 20px auto; }
        .progress-circle-bar { fill: none; stroke: var(--accent); stroke-width: 8; stroke-linecap: round; transform: rotate(-90deg); transform-origin: center; transition: 0.6s; }
        .date-picker { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 15px; scrollbar-width: none; }
        .date-item { min-width: 55px; height: 70px; background: white; border-radius: 18px; border: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .date-item.active { background: var(--accent); color: white; border-color: var(--accent); }
        .task-list { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; padding-bottom: 100px; }
        .task-item { background: white; padding: 18px; border-radius: 20px; display: flex; align-items: center; gap: 12px; border: 1px solid var(--border); }
        .task-item.done { opacity: 0.5; background: #f8fafc; }
        .checkbox { width: 24px; height: 24px; border: 2px solid var(--border); border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        .task-item.done .checkbox { background: var(--success); border-color: var(--success); color: white; }

        /* --- PAGE 3: CALENDRIER (ORIGINAL) --- */
        .calendar-wrapper { margin: 0 15px; background: var(--surface); backdrop-filter: blur(12px); border: 1px solid white; border-radius: 30px; box-shadow: var(--glass-shadow); overflow: hidden; display: flex; flex-direction: column; flex: 1; margin-bottom: 100px; }
        .agenda-header-wrapper { margin-left: 60px; overflow: hidden; border-bottom: 1px solid var(--border); }
        .days-row { display: flex; width: calc(var(--day-w) * 7); }
        .day-box { width: var(--day-w); padding: 20px 0; text-align: center; flex-shrink: 0; }
        .agenda-scroll { flex: 1; overflow: auto; position: relative; scrollbar-width: none; }
        .grid-master { display: flex; width: calc(60px + (var(--day-w) * 7)); position: relative; }
        .hours-column { width: 60px; position: sticky; left: 0; background: rgba(255,255,255,0.9); z-index: 10; border-right: 1px solid var(--border); }
        .hour-mark { height: var(--hour-h); font-size: 11px; font-weight: 600; color: var(--text-dim); text-align: center; padding-top: 10px; }
        .day-column { width: var(--day-w); position: relative; background-image: linear-gradient(var(--border) 1px, transparent 1px); background-size: 100% var(--hour-h); }
        .event-node { position: absolute; left: 8px; right: 8px; background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(168, 85, 247, 0.1)); border: 1px solid rgba(99, 102, 241, 0.2); border-radius: 16px; padding: 12px; font-size: 12px; font-weight: 700; color: var(--accent); }

        /* --- NAVIGATION --- */
        nav { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); width: 85%; height: 75px; background: rgba(255, 255, 255, 0.85); backdrop-filter: blur(20px); border-radius: 25px; border: 1px solid white; display: flex; justify-content: space-around; align-items: center; z-index: 1000; box-shadow: var(--glass-shadow); }
        .nav-link { font-size: 22px; color: #94A3B8; cursor: pointer; transition: 0.3s; }
        .nav-link.active { color: var(--accent); transform: translateY(-5px); }
        .add-float { width: 55px; height: 55px; background: linear-gradient(135deg, #6366F1, #A855F7); border-radius: 18px; display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; transform: rotate(45deg); box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3); }
        .add-float i { transform: rotate(-45deg); }

        /* --- MODAL --- */
        #modal { position: fixed; inset: 0; background: rgba(15, 23, 42, 0.4); backdrop-filter: blur(8px); display: none; align-items: center; justify-content: center; z-index: 2000; }
        .modal-ui { width: 90%; max-width: 400px; background: white; padding: 40px; border-radius: 40px; }
        input, select { width: 100%; background: #F8FAFC; border: 1px solid transparent; padding: 18px; border-radius: 18px; margin-bottom: 15px; outline: none; font-size: 16px; font-weight: 600; }
        .save-btn { background: var(--accent); color: white; border: none; width: 100%; padding: 18px; border-radius: 18px; font-weight: 700; }
    </style>
</head>
<body>

    <div id="page-home" class="page active-page">
        <div class="top-bar">
            <h1>GoalFlow.</h1>
            <div class="profile-mini"><i class="fa-solid fa-user"></i></div>
        </div>
        <div style="margin-top: 20px;">
            <p style="color: var(--accent); font-weight: 700; font-size: 14px; text-transform: uppercase;">Bonjour, Leader</p>
            <h1 class="hero-title">Façonnez votre<br>futur.</h1>
        </div>
        <div class="home-card-elite" onclick="goTo('weekly')">
            <h2>Agenda Stratégique</h2>
            <p style="font-size: 22px; font-weight: 700;">Visualiser vos ambitions</p>
            <div style="margin-top: 25px; color: var(--accent); font-weight: 800; font-size: 14px;">OUVRIR L'AGENDA <i class="fa-solid fa-arrow-right-long"></i></div>
        </div>
        <div class="stats-grid">
            <div class="stat-pill"><b>12</b><span>Streak</span></div>
            <div class="stat-pill"><b style="color: #10B981;">92%</b><span>Focus</span></div>
        </div>
    </div>

    <div id="page-focus" class="page">
        <div class="top-bar"><h1>Exécution.</h1></div>
        <div class="progress-circle-container">
            <svg width="100" height="100"><circle cx="50" cy="50" r="45" fill="none" stroke="#E2E8F0" stroke-width="8"/><circle id="p-bar" cx="50" cy="50" r="45" fill="none" class="progress-circle-bar" stroke-dasharray="282.7" stroke-dashoffset="282.7"/></svg>
            <div id="p-text" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-weight:800;">0%</div>
        </div>
        <div class="date-picker" id="focus-picker"></div>
        <div class="task-list" id="focus-list"></div>
    </div>

    <div id="page-weekly" class="page">
        <div class="top-bar"><h1>Structure Hebdo.</h1></div>
        <div class="calendar-wrapper">
            <div class="agenda-header-wrapper" id="header-view"><div class="days-row" id="header-cont"></div></div>
            <div class="agenda-scroll" id="grid-view">
                <div class="grid-master">
                    <div class="hours-column" id="hours-cont"></div>
                    <div id="days-cont" style="display: flex;"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="modal">
        <div class="modal-ui">
            <h2>Nouveau Plan</h2>
            <input type="text" id="t-title" placeholder="Quel est l'objectif ?">
            <select id="t-day"><option value="0">Lundi</option><option value="1">Mardi</option><option value="2">Mercredi</option><option value="3">Jeudi</option><option value="4">Vendredi</option><option value="5">Samedi</option><option value="6">Dimanche</option></select>
            <select id="t-hour"></select>
            <button class="save-btn" onclick="addObj()">Enregistrer</button>
            <p onclick="closeM()" style="text-align:center; margin-top:20px; color:var(--text-dim); cursor:pointer;">Annuler</p>
        </div>
    </div>

    <nav>
        <i class="fa-solid fa-house nav-link active" onclick="goTo('home')"></i>
        <i class="fa-solid fa-list-check nav-link" onclick="goTo('focus')"></i>
        <div class="add-float" onclick="openM()"><i class="fa-solid fa-plus"></i></div>
        <i class="fa-solid fa-calendar-days nav-link" onclick="goTo('weekly')"></i>
        <i class="fa-solid fa-gear nav-link"></i>
    </nav>

<script>
    let db = JSON.parse(localStorage.getItem('gf_final_db')) || {};
    let selectedDate = new Date().toISOString().split('T')[0];
    const dNames = ['LUN','MAR','MER','JEU','VEN','SAM','DIM'];

    for(let i=0; i<24; i++) document.getElementById('t-hour').innerHTML += `<option value="${i}">${i}:00</option>`;

    function goTo(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
        document.getElementById('page-'+id).classList.add('active-page');
        document.querySelectorAll('.nav-link').forEach((l, i) => {
            l.classList.remove('active');
            if(id === 'home' && i === 0) l.classList.add('active');
            if(id === 'focus' && i === 1) l.classList.add('active');
            if(id === 'weekly' && i === 3) l.classList.add('active');
        });
        if(id === 'focus') renderFocus();
        if(id === 'weekly') renderWeekly();
    }

    function openM() { document.getElementById('modal').style.display = 'flex'; }
    function closeM() { document.getElementById('modal').style.display = 'none'; }

    function renderFocus() {
        const p = document.getElementById('focus-picker'); const l = document.getElementById('focus-list');
        p.innerHTML = ''; l.innerHTML = '';
        const start = new Date(); start.setDate(new Date().getDate() - (new Date().getDay() === 0 ? 6 : new Date().getDay() - 1));
        for(let i=0; i<7; i++) {
            const d = new Date(start); d.setDate(start.getDate() + i); const key = d.toISOString().split('T')[0];
            p.innerHTML += `<div class="date-item ${key===selectedDate?'active':''}" onclick="selectedDate='${key}';renderFocus()"><span>${dNames[i]}</span><b>${d.getDate()}</b></div>`;
        }
        (db[selectedDate] || []).forEach((t, i) => {
            l.innerHTML += `<div class="task-item ${t.done?'done':''}" onclick="db['${selectedDate}'][${i}].done=!db['${selectedDate}'][${i}].done;save();renderFocus()"><div class="checkbox">${t.done?'✓':''}</div><div class="task-text">${t.title}</div></div>`;
        });
        updateProgress();
    }

    function updateProgress() {
        const t = db[selectedDate] || []; const d = t.filter(x => x.done).length;
        const pc = t.length ? Math.round((d/t.length)*100) : 0;
        document.getElementById('p-text').innerText = pc+'%';
        document.getElementById('p-bar').style.strokeDashoffset = 282.7 - (282.7 * pc / 100);
    }

    function renderWeekly() {
        const hr = document.getElementById('header-cont'); const dc = document.getElementById('days-cont'); const hc = document.getElementById('hours-cont');
        hr.innerHTML = dc.innerHTML = hc.innerHTML = '';
        const start = new Date(); start.setDate(new Date().getDate() - (new Date().getDay() === 0 ? 6 : new Date().getDay() - 1));
        for(let i=0; i<7; i++) {
            const d = new Date(start); d.setDate(start.getDate() + i); const key = d.toISOString().split('T')[0];
            hr.innerHTML += `<div class="day-box"><span>${dNames[i]}</span><b>${d.getDate()}</b></div>`;
            const col = document.createElement('div'); col.className = 'day-column';
            (db[key] || []).forEach(e => col.innerHTML += `<div class="event-node" style="top:${e.hour*90+10}px;height:70px;">${e.title}</div>`);
            dc.appendChild(col);
        }
        for(let i=0; i<24; i++) hc.innerHTML += `<div class="hour-mark">${i}:00</div>`;
        const gV = document.getElementById('grid-view'); const hV = document.getElementById('header-view');
        gV.onscroll = () => hV.scrollLeft = gV.scrollLeft;
    }

    function addObj() {
        const title = document.getElementById('t-title').value; const dIdx = parseInt(document.getElementById('t-day').value); const hour = parseInt(document.getElementById('t-hour').value);
        if(!title) return;
        const start = new Date(); start.setDate(start.getDate() - (start.getDay() === 0 ? 6 : start.getDay() - 1));
        const target = new Date(start); target.setDate(start.getDate() + dIdx); const key = target.toISOString().split('T')[0];
        if(!db[key]) db[key] = []; db[key].push({title, hour, done:false});
        save(); closeM(); goTo('weekly');
    }

    function save() { localStorage.setItem('gf_final_db', JSON.stringify(db)); }
    window.onload = () => renderWeekly();
</script>
</body>
</html>